<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <!-- Header fragment containing css and js imports -->
	<div th:replace="/fragments/header :: header-css"></div>
	<title>Travel Blog - Blog entries</title>
</head>
<body>
    <!-- Header fragment containing navbar -->
	<div th:replace="/fragments/header :: header"></div>

    <!-- Heading banner -->
    <div class="heading-page">
        <section class="page-heading">
            <div class="container">
                <div class="text-content">
                    <h2 th:if="${tag == null}">Recent Blog Entries</h2>
                    <div th:if="${tag != null}">
                        <h2 th:inline = "text">
                            [[${tag.name}]]
                        </h2>
                        <h4 th:text="${tag.description}"></h4>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Body section containing blog posts and sidebar -->
    <section class="blog-posts grid-system">
        <div class="container">
            <div class="row">
                <!-- Blog posts -->
                <div class="col-lg-8">
                    <div class="row">
                        <!-- Individual Blog posts -->
                        <div class="col-lg-6" th:each="tempAllPost : ${allPost}">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <a th:href="@{'/post/' + ${tempAllPost.id}}">
                                        <!-- Default image -->
                                        <div th:if="${tempAllPost.album == null || #lists.isEmpty(tempAllPost.album.photos)}">
                                            <img class="post-img" th:src="@{/images/defaultImage.jpeg}">
                                        </div>
                                        <!-- First image of album -->
                                        <div th:unless="${tempAllPost.album == null || #lists.isEmpty(tempAllPost.album.photos)}">
                                            <img class="post-img" th:src="@{'/' + ${tempAllPost.album.photos[0].albumImagePath}}">
                                        </div>
									</a>                                
                                </div>
                                <div class="down-content">
                                    <a th:href="@{'/post/' + ${tempAllPost.id}}">
                                        <h4 th:text="${tempAllPost.title}"></h4>
                                    </a>
                                    <ul class="post-info">
                                        <li>
                                            <a th:href="@{'/user/' + ${tempAllPost.user.username}}" th:text="${tempAllPost.user.username}"></a>
                                        </li>
                                        <li>
                                            <a th:text="${#temporals.format(tempAllPost.createdAt, 'MMMM dd, yyyy')}"></a>
                                        </li>
                                        <li>
                                            <a th:inline = "text">[[${#lists.size(tempAllPost.comments)}]] Comments</a>
                                        </li>
                                    </ul>
                                    <p th:text="${tempAllPost.description}"></p>
                                    <div class="post-options">
                                        <div class="row">
                                            <ul class="post-tags">
                                                <li><i class="fa fa-tags"></i></li>
                                                <li>
                                                    <a th:each="tempTag, iterStat : ${tempAllPost.tags}" th:href="@{'/tag/' + ${tempTag.id} + '/all'}" th:text="${tempTag.name} + ${!iterStat.last ? ', ' : ''}"></a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar fragment -->
                <div th:replace="/fragments/sidebar :: sidebar (latestPosts = ${latestPosts}, allTags = ${allTags})"></div>
            </div>
        </div>
    </section>

    <!-- Footer fragment -->
	<div th:replace="/fragments/footer :: footer"></div>
</body>
</html>